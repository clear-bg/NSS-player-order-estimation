<UserControl
  x:Class="NssOrderTool.Views.ArenaView"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="using:NssOrderTool.ViewModels"
  xmlns:vmArena="using:NssOrderTool.ViewModels.Arena"
  d:DesignHeight="600"
  d:DesignWidth="800"
  x:DataType="vm:ArenaViewModel"
  Focusable="True"
  mc:Ignorable="d">

  <UserControl.Styles>
    <Style Selector="Button.RoundBtn /template/ ContentPresenter#PART_ContentPresenter">
      <Setter Property="Transitions">
        <Transitions>
          <BrushTransition Property="Background" Duration="0:0:0.2" />
        </Transitions>
      </Setter>
    </Style>

    <Style x:CompileBindings="False" Selector="Button.RoundBtn:pointerover /template/ ContentPresenter#PART_ContentPresenter">
      <Setter Property="Background" Value="{Binding HoverColor}" />
    </Style>

    <Style Selector="TextBox.PlayerNameBox:pointerover /template/ Border#PART_BorderElement">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderBrush" Value="Transparent" />
    </Style>

    <Style Selector="TextBox.PlayerNameBox:focus /template/ Border#PART_BorderElement">
      <Setter Property="Background" Value="Transparent" />
      <Setter Property="BorderBrush" Value="Transparent" />
    </Style>

    <Style Selector="TextBox.PlayerNameBox">
      <Setter Property="CaretBrush" Value="Black" />
    </Style>

    <Style Selector="Border.Cell">
      <Setter Property="BorderThickness" Value="0,0,1,1" />
      <Setter Property="BorderBrush" Value="#808080" />
    </Style>

    <Style Selector="Border.HeaderBottom">
      <Setter Property="BorderThickness" Value="0,0,1,3" />
      <Setter Property="BorderBrush" Value="#606060" />
    </Style>

    <Style Selector="Border.HeaderRight">
      <Setter Property="BorderThickness" Value="0,0,3,1" />
      <Setter Property="BorderBrush" Value="#606060" />
    </Style>

    <Style Selector="Border.HeaderCorner">
      <Setter Property="BorderThickness" Value="0,0,3,3" />
      <Setter Property="BorderBrush" Value="#606060" />
    </Style>

    <Style Selector="Border.DoubleBottom">
      <Setter Property="BorderThickness" Value="0,0,1,1" />
      <Setter Property="Padding" Value="0,0,0,1" />
    </Style>

    <Style Selector="Border.DoubleRight">
      <Setter Property="BorderThickness" Value="0,0,1,1" />
      <Setter Property="Padding" Value="0,0,1,0" />
    </Style>

    <Style Selector="Border.DoubleCorner">
      <Setter Property="BorderThickness" Value="0,0,1,1" />
      <Setter Property="Padding" Value="0,0,1,1" />
    </Style>

    <Style Selector="Border#CaptureTarget">
      <Setter Property="Padding" Value="10" />
    </Style>
  </UserControl.Styles>

  <Grid Margin="5,15,15,15" RowDefinitions="Auto, *, Auto, Auto">

    <StackPanel
      Grid.Row="0"
      Margin="0,0,0,15"
      Spacing="10">
      <TextBlock
        FontSize="20"
        FontWeight="Medium"
        Text="ðŸŸï¸ ã‚¢ãƒªãƒ¼ãƒŠé›†è¨ˆ" />
      <TextBlock
        FontSize="13"
        Foreground="#666666"
        Text="ä¸‹ã®ãƒœã‚¿ãƒ³ã§å„ãƒ©ã‚¦ãƒ³ãƒ‰ã®å‹åˆ©ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã‚¹ã‚³ã‚¢ãŒè‡ªå‹•è¨ˆç®—ã•ã‚Œã¾ã™ã€‚" />
    </StackPanel>

    <Border Grid.Row="1" Background="White">

      <Border
        Background="#f0f8ff"
        BorderBrush="#808080"
        BorderThickness="1">
        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
          <Border
            x:Name="CaptureTarget"
            Padding="15"
            Background="White">
            <StackPanel Margin="15" HorizontalAlignment="Left">

              <Border
                x:Name="ArenaTableBorder"
                BorderBrush="#808080"
                BorderThickness="3,3,2,2">

                <StackPanel>
                  <StackPanel Orientation="Horizontal">
                    <Border
                      Width="100"
                      Height="28"
                      Background="#bbbbbb"
                      BorderBrush="#555555"
                      Classes="DoubleCorner">

                      <Border BorderBrush="#555555" BorderThickness="0,0,1,1">
                        <TextBlock
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          FontSize="12"
                          FontWeight="Medium"
                          Foreground="#333333"
                          Text="Player" />
                      </Border>
                    </Border>

                    <ItemsControl ItemsSource="{Binding RoundInputs}">
                      <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                          <StackPanel Orientation="Horizontal" Spacing="0" />
                        </ItemsPanelTemplate>
                      </ItemsControl.ItemsPanel>
                      <ItemsControl.ItemTemplate>
                        <DataTemplate>
                          <Border
                            Width="40"
                            Height="28"
                            Background="#bbbbbb"
                            BorderBrush="#555555"
                            Classes="DoubleBottom">

                            <Border BorderBrush="#555555" BorderThickness="0,0,0,1">
                              <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="11"
                                FontWeight="Medium"
                                Foreground="#555555"
                                Text="{Binding RoundNumber, StringFormat='R{0}'}" />
                            </Border>
                          </Border>
                        </DataTemplate>
                      </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Border
                      Width="40"
                      Height="28"
                      Padding="1,0,0,1"
                      Background="#bbbbbb"
                      BorderBrush="#555555"
                      BorderThickness="0,0,1,1">
                      <Border BorderBrush="#555555" BorderThickness="1,0,0,1">
                        <TextBlock
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          FontSize="12"
                          FontWeight="Medium"
                          Foreground="#2E7D32"
                          Text="Win" />
                      </Border>
                    </Border>
                    <Border
                      Width="40"
                      Height="28"
                      Background="#bbbbbb"
                      BorderBrush="#555555"
                      Classes="DoubleBottom">

                      <Border BorderBrush="#555555" BorderThickness="0,0,0,1">
                        <TextBlock
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          FontSize="12"
                          FontWeight="Medium"
                          Foreground="#2E7D32"
                          Text="Rank" />
                      </Border>
                    </Border>
                  </StackPanel>

                  <ItemsControl ItemsSource="{Binding PlayerRows}" KeyboardNavigation.TabNavigation="Continue">
                    <ItemsControl.ItemTemplate>
                      <DataTemplate x:DataType="vmArena:ArenaRowViewModel">
                        <StackPanel Orientation="Horizontal">

                          <Border
                            Width="100"
                            Height="28"
                            Background="#dbdbdb"
                            BorderBrush="#555555"
                            Classes="DoubleRight">

                            <Border BorderBrush="#555555" BorderThickness="0,0,1,0">
                              <TextBox
                                MinHeight="0"
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                VerticalContentAlignment="Center"
                                Background="Transparent"
                                BorderThickness="0"
                                Classes="PlayerNameBox"
                                CornerRadius="0"
                                FontSize="14"
                                FontWeight="Medium"
                                Foreground="#333333"
                                GotFocus="OnNameInputGotFocus"
                                KeyDown="OnNameInputKeyDown"
                                Text="{Binding Name, UpdateSourceTrigger=LostFocus}" />
                            </Border>
                          </Border>

                          <ItemsControl ItemsSource="{Binding Cells}">
                            <ItemsControl.ItemsPanel>
                              <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                              </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                              <DataTemplate x:DataType="vmArena:ArenaCellViewModel">
                                <Border
                                  Width="40"
                                  Height="28"
                                  Background="{Binding CellColor}"
                                  BorderBrush="#555555"
                                  Classes="Cell">
                                  <TextBlock
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="14"
                                    FontWeight="Medium"
                                    Foreground="{Binding ForeColor}"
                                    Text="{Binding ResultMark}" />
                                </Border>
                              </DataTemplate>
                            </ItemsControl.ItemTemplate>
                          </ItemsControl>

                          <Border
                            Width="40"
                            Height="28"
                            Padding="1,0,0,0"
                            Background="#C6E0B4"
                            BorderBrush="#555555"
                            BorderThickness="0,0,1,1">
                            <Border BorderBrush="#555555" BorderThickness="1,0,0,0">
                              <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="14"
                                FontWeight="Medium"
                                Foreground="#333333"
                                Text="{Binding WinCount}" />
                            </Border>
                          </Border>
                          <Border
                            Width="40"
                            Height="28"
                            Background="#C6E0B4"
                            BorderBrush="#555555"
                            Classes="Cell">
                            <TextBlock
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center"
                              FontSize="14"
                              FontWeight="Medium"
                              Foreground="#333333"
                              Text="{Binding Rank}" />
                          </Border>

                        </StackPanel>
                      </DataTemplate>
                    </ItemsControl.ItemTemplate>
                  </ItemsControl>
                </StackPanel>
              </Border>
            </StackPanel>
          </Border>
        </ScrollViewer>
      </Border>
    </Border>

    <StackPanel
      Grid.Row="2"
      Margin="15,10,15,10"
      Orientation="Horizontal">

      <Border
        Width="120"
        Height="1"
        Margin="0"
        Background="Transparent" />

      <ItemsControl ItemsSource="{Binding RoundInputs}">
        <ItemsControl.ItemsPanel>
          <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal" Spacing="0" />
          </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Button
              Width="39"
              Height="40"
              Margin="0,0,1,0"
              Padding="0"
              Background="{Binding CellColor}"
              BorderBrush="#606060"
              BorderThickness="1"
              Classes="RoundBtn"
              Command="{Binding ToggleWinnerCommand}"
              CornerRadius="4">
              <Grid RowDefinitions="Auto, *">
                <TextBlock
                  Margin="0,4,0,0"
                  HorizontalAlignment="Center"
                  FontSize="11"
                  Foreground="#333333"
                  Opacity="0.9"
                  Text="{Binding RoundNumber, StringFormat='R{0}'}" />
                <TextBlock
                  Grid.Row="1"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  FontSize="13"
                  FontWeight="Black"
                  Foreground="#333333"
                  Text="{Binding DisplayText}" />
              </Grid>
            </Button>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
    </StackPanel>

    <StackPanel
      Grid.Row="3"
      Margin="0,15"
      VerticalAlignment="Top"
      Orientation="Horizontal"
      Spacing="20">

      <Button
        Padding="30,12"
        Background="#007ACC"
        Command="{Binding SaveSessionCommand}"
        CornerRadius="6">
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock
            VerticalAlignment="Center"
            FontSize="16"
            Text="ðŸ’¾" />
          <TextBlock
            VerticalAlignment="Center"
            FontSize="14"
            FontWeight="Medium"
            Foreground="White"
            Text="çµæžœã‚’ä¿å­˜ã™ã‚‹" />
        </StackPanel>
      </Button>

      <Button
        Padding="20,12"
        Background="#606060"
        Click="OnCopyToClipboardClick"
        CornerRadius="6">
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock
            VerticalAlignment="Center"
            FontSize="16"
            Text="ðŸ“‹" />
          <TextBlock
            VerticalAlignment="Center"
            FontSize="14"
            FontWeight="Medium"
            Foreground="White"
            Text="ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼" />
        </StackPanel>
      </Button>

      <Button
        Padding="20,12"
        Background="#606060"
        Click="OnScreenshotClick"
        CornerRadius="6">
        <StackPanel Orientation="Horizontal" Spacing="8">
          <TextBlock
            VerticalAlignment="Center"
            FontSize="16"
            Text="ðŸ“·" />
          <TextBlock
            VerticalAlignment="Center"
            FontSize="14"
            FontWeight="Medium"
            Foreground="White"
            Text="ç”»åƒã¨ã—ã¦ä¿å­˜" />
        </StackPanel>
      </Button>

      <TextBlock
        VerticalAlignment="Center"
        FontSize="14"
        FontWeight="Medium"
        Foreground="#2E7D32"
        Text="{Binding StatusText}" />
    </StackPanel>

  </Grid>
</UserControl>
