<UserControl
  x:Class="NssOrderTool.Views.ArenaDataView"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="using:NssOrderTool.ViewModels"
  d:DesignHeight="800"
  d:DesignWidth="800"
  x:DataType="vm:ArenaDataViewModel"
  Background="Transparent"
  Focusable="True"
  KeyDown="OnRootKeyDown"
  PointerPressed="OnRootPointerPressed"
  mc:Ignorable="d">

  <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="20" Spacing="20">

      <Border
        Padding="0,0,0,20"
        BorderBrush="#444444"
        BorderThickness="0,0,0,1">
        <StackPanel
          VerticalAlignment="Center"
          Orientation="Horizontal"
          Spacing="10">
          <TextBlock
            VerticalAlignment="Center"
            FontWeight="Medium"
            Text="ðŸ” ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ¤œç´¢:" />
          <AutoCompleteBox
            Width="250"
            FilterMode="Contains"
            ItemsSource="{Binding Players}"
            SelectedItem="{Binding SelectedPlayer}"
            Text="{Binding SearchText}"
            ValueMemberBinding="{Binding Name}"
            Watermark="åå‰ã‚’å…¥åŠ›ã—ã¦é¸æŠž..." />
          <TextBlock
            Margin="10,0,0,0"
            VerticalAlignment="Center"
            Foreground="Gray"
            Text="{Binding SelectedPlayer.Name, StringFormat='é¸æŠžä¸­: {0}', TargetNullValue='(æœªé¸æŠž)'}" />
        </StackPanel>
      </Border>

      <StackPanel
        Margin="20"
        HorizontalAlignment="Center"
        IsVisible="{Binding IsLoadingDetails}">
        <ProgressBar
          Width="200"
          Height="4"
          Margin="0,0,0,10"
          IsIndeterminate="True" />
        <TextBlock
          HorizontalAlignment="Center"
          Foreground="Gray"
          Text="ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆä¸­..." />
      </StackPanel>

      <StackPanel IsVisible="{Binding Details, Converter={x:Static ObjectConverters.IsNotNull}}" Spacing="20">
        <Border
          Padding="20"
          Background="#252526"
          BorderBrush="#3E3E42"
          BorderThickness="1"
          CornerRadius="5">
          <Grid ColumnDefinitions="*, *, *, *, *">
            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="12"
                Foreground="Gray"
                Text="ç·å‚åŠ æ•°" />
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Text="{Binding Details.Stats.TotalSessions, StringFormat='{}{0} å›ž'}" />
            </StackPanel>
            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="12"
                Foreground="Gray"
                Text="å„ªå‹å›žæ•°" />
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Foreground="#FFD700"
                Text="{Binding Details.Stats.SessionWins, StringFormat='{}{0} å›ž'}" />
            </StackPanel>
            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="12"
                Foreground="Gray"
                Text="ãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°" />
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Foreground="#5eff00"
                Text="{Binding DisplayRating}" />
            </StackPanel>
            <StackPanel Grid.Column="3" HorizontalAlignment="Center">
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="12"
                Foreground="Gray"
                Text="å‹çŽ‡" />
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Text="{Binding Details.Stats.SessionWinRate, StringFormat='{}{0:P1}'}" />
            </StackPanel>
            <StackPanel Grid.Column="4" HorizontalAlignment="Center">
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="12"
                Foreground="Gray"
                Text="å¹³å‡é †ä½" />
              <TextBlock
                HorizontalAlignment="Center"
                FontSize="24"
                FontWeight="Bold"
                Text="{Binding Details.Stats.AverageRank, StringFormat='{}{0:F2} ä½'}" />
            </StackPanel>
          </Grid>
        </Border>

        <Grid ColumnDefinitions="*, 20, *">
          <StackPanel Grid.Column="0" Spacing="20">
            <Border
              Padding="15"
              Background="#1E1E1E"
              BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="5">
              <StackPanel Spacing="10">
                <Border
                  Padding="0,0,0,5"
                  BorderBrush="#333333"
                  BorderThickness="0,0,0,1">
                  <TextBlock
                    FontSize="16"
                    FontWeight="Bold"
                    Foreground="#FFD700"
                    Text="ðŸ† Top 20 ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼" />
                </Border>

                <ItemsControl ItemsSource="{Binding TopRanking}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Grid Margin="0,4" ColumnDefinitions="30, *, Auto">
                        <Border
                          Grid.Column="0"
                          Width="24"
                          Height="24"
                          Background="#333333"
                          CornerRadius="12">
                          <TextBlock
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            FontSize="11"
                            FontWeight="Bold"
                            Text="{Binding Rank}" />
                        </Border>

                        <TextBlock
                          Grid.Column="1"
                          Margin="10,0"
                          VerticalAlignment="Center"
                          Text="{Binding Name}"
                          TextTrimming="CharacterEllipsis" />

                        <TextBlock
                          Grid.Column="2"
                          VerticalAlignment="Center"
                          FontWeight="Bold"
                          Foreground="#5eff00"
                          Text="{Binding Rating}" />
                      </Grid>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>

            <Border
              Padding="15"
              Background="#1E1E1E"
              BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="5">
              <StackPanel Spacing="10">
                <TextBlock
                  FontSize="16"
                  FontWeight="Bold"
                  Text="ðŸ“Š ãƒãƒ¼ãƒ åˆ¥ãƒ©ã‚¦ãƒ³ãƒ‰æˆç¸¾" />
                <Grid ColumnDefinitions="*, Auto, *">
                  <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock
                      HorizontalAlignment="Center"
                      FontWeight="Bold"
                      Foreground="#4488FF"
                      Text="ðŸ”µ Blue" />
                    <TextBlock
                      HorizontalAlignment="Center"
                      FontSize="18"
                      Text="{Binding Details.Stats.BlueWinRate, StringFormat='å‹çŽ‡ {0:P1}'}" />
                    <StackPanel
                      HorizontalAlignment="Center"
                      Orientation="Horizontal"
                      Spacing="2">
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="{Binding Details.Stats.BlueWins}" />
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="/" />
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="{Binding Details.Stats.BlueRounds}" />
                    </StackPanel>
                  </StackPanel>
                  <Border
                    Grid.Column="1"
                    Width="1"
                    Margin="10,0"
                    Background="#444444" />
                  <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock
                      HorizontalAlignment="Center"
                      FontWeight="Bold"
                      Foreground="#FF8844"
                      Text="ðŸŸ  Orange" />
                    <TextBlock
                      HorizontalAlignment="Center"
                      FontSize="18"
                      Text="{Binding Details.Stats.OrangeWinRate, StringFormat='å‹çŽ‡ {0:P1}'}" />
                    <StackPanel
                      HorizontalAlignment="Center"
                      Orientation="Horizontal"
                      Spacing="2">
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="{Binding Details.Stats.OrangeWins}" />
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="/" />
                      <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        Text="{Binding Details.Stats.OrangeRounds}" />
                    </StackPanel>
                  </StackPanel>
                </Grid>
              </StackPanel>
            </Border>

            <Border
              Background="#1E1E1E"
              BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="5">
              <StackPanel>
                <Border
                  Padding="15,10"
                  BorderBrush="#333333"
                  BorderThickness="0,0,0,1">
                  <TextBlock FontWeight="Bold" Text="ðŸ“… ç›´è¿‘ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¥æ­´" />
                </Border>
                <ItemsControl ItemsSource="{Binding Details.History}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border
                        Padding="15,8"
                        BorderBrush="#333333"
                        BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="100, 60, 60, *">
                          <TextBlock
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            Foreground="Gray"
                            Text="{Binding Date, StringFormat='MM/dd HH:mm'}" />
                          <TextBlock
                            Grid.Column="1"
                            VerticalAlignment="Center"
                            FontWeight="Bold"
                            Text="{Binding Result}" />
                          <TextBlock
                            Grid.Column="2"
                            VerticalAlignment="Center"
                            Text="{Binding WinCount, StringFormat='{}{0}å‹'}" />
                          <TextBlock
                            Grid.Column="3"
                            VerticalAlignment="Center"
                            FontSize="11"
                            Foreground="Gray"
                            Text="{Binding PartnerName}"
                            TextTrimming="CharacterEllipsis" />
                        </Grid>
                      </Border>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </StackPanel>
            </Border>
          </StackPanel>

          <StackPanel Grid.Column="2" Spacing="20">
            <Border
              Background="#1E1E1E"
              BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="5">
              <StackPanel>
                <Border
                  Padding="15,10"
                  Background="#1E2A1E"
                  BorderBrush="#333333"
                  BorderThickness="0,0,0,1">
                  <TextBlock
                    FontWeight="Bold"
                    Foreground="#88FF88"
                    Text="ðŸ¤ ãƒ™ã‚¹ãƒˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ (å‘³æ–¹æ™‚å‹çŽ‡)" />
                </Border>
                <ItemsControl ItemsSource="{Binding Details.BestPartners}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border
                        Padding="15,8"
                        BorderBrush="#333333"
                        BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*, Auto">
                          <StackPanel Grid.Column="0">
                            <TextBlock FontWeight="Bold" Text="{Binding PlayerName}" />
                            <TextBlock
                              FontSize="11"
                              Foreground="Gray"
                              Text="{Binding RoundCount, StringFormat='å…±æ¼” {0}ãƒ©ã‚¦ãƒ³ãƒ‰'}" />
                          </StackPanel>
                          <TextBlock
                            Grid.Column="1"
                            VerticalAlignment="Center"
                            FontSize="18"
                            FontWeight="Bold"
                            Foreground="#88FF88"
                            Text="{Binding WinRate, StringFormat='{}{0:P0}'}" />
                        </Grid>
                      </Border>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
                <TextBlock
                  Margin="10"
                  HorizontalAlignment="Right"
                  FontSize="10"
                  Foreground="Gray"
                  Text="â€»5ãƒ©ã‚¦ãƒ³ãƒ‰ä»¥ä¸Šå…±æ¼”ã—ãŸç›¸æ‰‹ã®ã¿" />
              </StackPanel>
            </Border>

            <Border
              Background="#1E1E1E"
              BorderBrush="#333333"
              BorderThickness="1"
              CornerRadius="5">
              <StackPanel>
                <Border
                  Padding="15,10"
                  Background="#2A1E1E"
                  BorderBrush="#333333"
                  BorderThickness="0,0,0,1">
                  <TextBlock
                    FontWeight="Bold"
                    Foreground="#FF8888"
                    Text="âš”ï¸ ãƒ©ã‚¤ãƒãƒ« (æ•µå¯¾æ™‚å‹çŽ‡)" />
                </Border>
                <ItemsControl ItemsSource="{Binding Details.WorstRivals}">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <Border
                        Padding="15,8"
                        BorderBrush="#333333"
                        BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*, Auto">
                          <StackPanel Grid.Column="0">
                            <TextBlock FontWeight="Bold" Text="{Binding PlayerName}" />
                            <TextBlock
                              FontSize="11"
                              Foreground="Gray"
                              Text="{Binding RoundCount, StringFormat='å¯¾æˆ¦ {0}ãƒ©ã‚¦ãƒ³ãƒ‰'}" />
                          </StackPanel>
                          <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                            <TextBlock
                              HorizontalAlignment="Right"
                              FontSize="9"
                              Foreground="Gray"
                              Text="è‡ªåˆ†ã®å‹çŽ‡" />
                            <TextBlock
                              HorizontalAlignment="Right"
                              FontSize="18"
                              FontWeight="Bold"
                              Foreground="#FF8888"
                              Text="{Binding WinRate, StringFormat='{}{0:P0}'}" />
                          </StackPanel>
                        </Grid>
                      </Border>
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
                <TextBlock
                  Margin="10"
                  HorizontalAlignment="Right"
                  FontSize="10"
                  Foreground="Gray"
                  Text="â€»5ãƒ©ã‚¦ãƒ³ãƒ‰ä»¥ä¸Šå¯¾æˆ¦ã—ãŸç›¸æ‰‹ã®ã¿" />
              </StackPanel>
            </Border>
          </StackPanel>
        </Grid>
      </StackPanel>

      <StackPanel
        Margin="0,50,0,0"
        HorizontalAlignment="Center"
        IsVisible="{Binding Details, Converter={x:Static ObjectConverters.IsNull}}">
        <TextBlock
          FontSize="16"
          Foreground="Gray"
          Text="ðŸ‘ˆ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é¸æŠžã™ã‚‹ã¨è©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™" />
      </StackPanel>

    </StackPanel>
  </ScrollViewer>
</UserControl>
