<UserControl
  x:Class="NssOrderTool.Views.OrderEstimationView"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="using:NssOrderTool.ViewModels"
  d:DesignHeight="500"
  d:DesignWidth="800"
  x:DataType="vm:OrderEstimationViewModel"
  mc:Ignorable="d">

  <Grid
    Margin="10"
    ColumnDefinitions="*, 20, *"
    IsEnabled="{Binding !IsBusy}">

    <StackPanel Grid.Column="0" Spacing="10">
      <ProgressBar
        Height="4"
        Margin="0,0,0,5"
        HorizontalAlignment="Stretch"
        IsIndeterminate="True"
        IsVisible="{Binding IsBusy}" />

      <StackPanel
        VerticalAlignment="Center"
        Orientation="Horizontal"
        Spacing="10">
        <TextBlock
          VerticalAlignment="Center"
          FontSize="16"
          FontWeight="Bold"
          Text="âœï¸ å…¥åŠ›" />
        <Border
          Padding="8,2"
          Background="{Binding EnvBadgeColor}"
          CornerRadius="4">
          <TextBlock
            FontSize="12"
            FontWeight="Bold"
            Foreground="White"
            Text="{Binding EnvText}" />
        </Border>
      </StackPanel>

      <TextBlock
        FontSize="12"
        Foreground="Gray"
        Text="ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åã‚’ã‚«ãƒ³ãƒžåŒºåˆ‡ã‚Šã§å…¥åŠ› (ä¾‹: A, B, C)" />

      <TextBox
        Height="100"
        AcceptsReturn="True"
        Text="{Binding InputText}"
        TextWrapping="Wrap"
        Watermark="ä¾‹: Player1, Player2, Player3" />

      <Button
        HorizontalAlignment="Stretch"
        HorizontalContentAlignment="Center"
        Background="#007ACC"
        Command="{Binding RegisterCommand}"
        Content="ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²"
        Foreground="White" />

      <TextBlock
        Foreground="Green"
        Text="{Binding StatusText}"
        TextWrapping="Wrap" />

      <Separator Margin="0" />

      <Grid ColumnDefinitions="Auto, *">
        <Button
          Grid.Column="0"
          Padding="8,4"
          Click="CopyGraphButton_Click"
          Content="ðŸ“‹ Graph"
          FontSize="12"
          ToolTip.Tip="Mermaidå½¢å¼ã§ã‚°ãƒ©ãƒ•ã‚’ã‚³ãƒ”ãƒ¼" />

        <TextBlock
          Grid.Column="1"
          Margin="10,0,0,0"
          VerticalAlignment="Center"
          FontSize="12"
          Foreground="Gray"
          Text="{Binding StatsText}" />
      </Grid>

      <Separator Margin="0" />
      <TextBlock
        VerticalAlignment="Center"
        FontSize="14"
        FontWeight="Bold"
        Text="ðŸ“œ ç™»éŒ²å±¥æ­´ (æœ€æ–°50ä»¶)" />

      <ListBox
        Height="150"
        Background="#F9F9F9"
        ItemsSource="{Binding HistoryList}">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <Grid ColumnDefinitions="*, Auto">
              <TextBlock
                Grid.Column="0"
                VerticalAlignment="Center"
                FontSize="11"
                Foreground="#333333"
                Text="{Binding DisplayText}" />

              <Button
                Grid.Column="1"
                Margin="5,0,0,0"
                Padding="5,2"
                Background="Transparent"
                Command="{Binding $parent[UserControl].((vm:OrderEstimationViewModel)DataContext).DeleteHistoryCommand}"
                CommandParameter="{Binding}"
                Content="ðŸ—‘ï¸"
                FontSize="10"
                Foreground="Red" />
            </Grid>
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>
    </StackPanel>

    <StackPanel Grid.Column="2" Spacing="10">
      <Grid ColumnDefinitions="*, Auto, Auto">
        <TextBlock
          Grid.Column="0"
          VerticalAlignment="Center"
          FontSize="16"
          FontWeight="Bold"
          Text="ðŸ“Š æŽ¨å®šé †åº" />
        <Button
          Grid.Column="1"
          Margin="0,0,5,0"
          Command="{Binding ReloadCommand}"
          Content="æ›´æ–°" />

        <Button
          Name="ClearButton"
          Grid.Column="2"
          Background="#FFCCCC"
          Click="ClearButton_Click"
          Content="ðŸ—‘ï¸ åˆæœŸåŒ–"
          Foreground="Red" />
      </Grid>

      <ListBox
        Height="380"
        Background="#F0F0F0"
        Foreground="Black"
        ItemsSource="{Binding RankingList}">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <TextBlock
              Padding="5"
              Foreground="Black"
              Text="{Binding}" />
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>
    </StackPanel>
  </Grid>
</UserControl>
